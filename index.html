<!DOCTYPE html>
<html>
    <head>
        <title>Gear.js</title>
        <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open+Sans" />
        <link rel="stylesheet" type="text/css" href="docs/index.css" />
        <link rel="stylesheet" type="text/css" href="docs/monokai.css" />

        <script type="text/javascript" src="docs/highlight.min.js"></script>
        <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

        <script type="text/javascript" src="http://yui.yahooapis.com/combo?3.5.1/build/yui/yui-min.js"></script>
        <script type="text/javascript" src="https://github.com/yahoo/gear-lib/raw/master/build/gear-lib.js"></script>
        <script type="text/javascript" src="build/gear.js"></script>
    </head>
    <body>
        <header>
            <h1>Gear.js</h1>

            <h2>Download</h2>
            <ul>
                <li><a href="https://github.com/yahoo/gear/raw/master/build/gear.js">Development</a></li>
                <li><a href="https://github.com/yahoo/gear/raw/master/build/gear.min.js">Production</a></li>
            </ul>
        </header>

        <section>
            <h3>Task-Based Build System</h3>

            <p>Gear.js is a scriptable build system using simple tasks that act like a sequence of piped commands.</p>

            <h4>Features include:</h4>
            <ul>
                <li>Basic building blocks that can be combined to perform complex builds.</li>
                <li>Tasks are simply defined and keep system internals to a minimum.</li>
                <li>Asynchronous execution.</li>
                <li>Extensible task loading via NPM, file, or directory.</li>
                <li>Advanced flow control for complex task execution.</li>
            </ul>

            <div>
                <h4>Installation</h4>

                <h5>Node</h5>

                <p>To get the most out of Gear.js install <a href="/twobit/gear-lib">gear-lib</a> which contains tasks for linting, minifying, and deploying JS/CSS assets.</p>

<pre><code class="bash">$ npm install gear
$ npm install gear-lib
</code></pre>

                <h5>Browser</h5>

<pre><code class="html">&lt;script type=&quot;text/javascript&quot; src=&quot;https://github.com/yahoo/gear-lib/raw/master/build/gear-lib.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;https://github.com/yahoo/gear/raw/master/build/gear.js&quot;&gt;&lt;/script&gt;
</code></pre>
            </div>
            
            <a name="documentation"></a>
            <input type="file" id="files" name="files[]" multiple />

            <div>
                <h2>load()</h2>
                <p>Loads blobs from different sources.</p>

                <h3>Arguments</h3>
                <p>sources - List of sources.</p>

                <div class="example">
                    <button type="button"><span class="run">Run</span><span class="clear">Clear</span></button>

                    <div class="code">
<pre><code class="javascript">new Queue()
    .load(files)
    .run(function(err, results) {
        console.log(('' + results[0]).length + ' characters');
    });</code></pre>
                    </div>
                    
                    <div class="result"><pre></pre></div>
                </div>
            </div>

            <div>
                <h2>tasks()</h2>

                <div class="example">
                    <button type="button"><span class="run">Run</span><span class="clear">Clear</span></button>

                    <div class="code">
<pre><code class="javascript">new Queue()
    .load(files)
    .tasks({
        dev:     {task: ['write', 'output.js']},
        prodmin: {task: 'jsminify'},
        prod:    {requires: 'prodmin', task: ['write', 'output.min.js']},
        join:    {requires: ['dev', 'prod']}
    })
    .run(function(err, results) {
        console.log(results);
    });</code></pre>
                    </div>

                    <div class="result"><pre></pre></div>
                </div>
            </div>
        </section>

        <script type="text/javascript">
        YUI().use('event', function(Y) {
            var Queue = gear.Queue,
                Registry = gear.Registry,
                files = ['index.js'];

            localStorage['index.js'] = 'console.log (    "HI"   );\n\n';

            Y.one('#files').on('change', function(e) {
                var raw_files = e.currentTarget.getDOMNode().files;

                Array.prototype.forEach.call(raw_files, function(file) {
                    var reader = new FileReader();

                    reader.onload = function(e) {
                        localStorage[file.name] = e.target.result;
                        files.push(file.name);
                    };

                    reader.onerror = function(e) {
                        alert("Can't read local files");
                    };

                    reader.readAsBinaryString(file);
                });
            });

            Y.all('.example button').on('click', function(e) {
                var example = e.currentTarget.get('parentNode');

                if (!example.hasClass('show')) {
                    var code = example.one('.code pre').get('text'),
                        result = example.one('.result pre'),
                        _console = window.console,
                        console = {
                            log: function(msg) {
                                if (_console) {_console.log(msg);}
                                result.set('text', '> ' + result.get('text') + JSON.stringify(msg));
                            },
                            error: function(msg) {
                                if (_console) {_console.error(msg);}
                                result.set('text', '> ' + result.get('text') + JSON.stringify(msg));
                            }
                        };

                    result.set('text', '');

                    var ret = eval(code);
                    if (ret !== undefined) {console.log(ret);}
                }

                example.toggleClass('show');
            });
        });
        </script>
    </body>
</html>